# ATL Chat â€” Development Overlay (.env.dev)
# Copy to .env.dev and merge with .env. Used by: just dev
# Docker Compose loads: .env then .env.dev (later overrides).
#
# Create: cp .env.dev.example .env.dev
# Then run: just dev

# =============================================================================
# LOCALHOST DOMAINS (required for just dev)
# =============================================================================
ATL_ENVIRONMENT=dev

# Bind ports to localhost (override production Tailscale IPs)
ATL_CHAT_IP=127.0.0.1

# IRC: use localhost domain for UnrealIRCd/Atheme
IRC_DOMAIN=irc.localhost

# IRC cert paths (shared data/certs layout)
IRC_SSL_CERT_PATH=/home/unrealircd/unrealircd/certs/live/irc.localhost/fullchain.pem
IRC_SSL_KEY_PATH=/home/unrealircd/unrealircd/certs/live/irc.localhost/privkey.pem

# XMPP/Prosody: use localhost domain (Prosody VirtualHost, MUC, component JIDs)
XMPP_DOMAIN=xmpp.localhost
PROSODY_DOMAIN=xmpp.localhost

# Use SQLite for dev (no PostgreSQL container needed). Prod can use PROSODY_STORAGE=sql + xmpp-postgres.
PROSODY_STORAGE=sqlite

# Prosody upload/proxy URLs
PROSODY_UPLOAD_EXTERNAL_URL=http://xmpp.localhost:5280/upload/
PROSODY_PROXY_ADDRESS=xmpp.localhost
PROSODY_SSL_KEY=certs/live/xmpp.localhost/privkey.pem
PROSODY_SSL_CERT=certs/live/xmpp.localhost/fullchain.pem

# Bridge XMPP component: JID and server (Docker hostname)
BRIDGE_XMPP_COMPONENT_JID=bridge.xmpp.localhost
BRIDGE_XMPP_COMPONENT_SERVER=atl-xmpp-server
BRIDGE_XMPP_COMPONENT_PORT=5347

# IRC server hostname for bridge config (Docker service name)
IRC_BRIDGE_SERVER=atl-irc-server

# Disable Portal for local testing (IRC uses main client, XMPP uses fallback nicks)
BRIDGE_PORTAL_BASE_URL=

# Enable IRC puppets without Portal: each Discord user gets own IRC connection (atl_dev_{id} or custom nicks)
# BRIDGE_DEV_IRC_PUPPETS=true
# BRIDGE_DEV_IRC_NICK_MAP=123456789012345678:atl-o,987654321098765432:atl-user

# Disable IRC TLS cert verification (self-signed dev certs)
BRIDGE_IRC_TLS_VERIFY=false

# RELAYMSG: use clean nicks (no /d suffix) when UnrealIRCd relaymsg has require-separator no
BRIDGE_RELAYMSG_CLEAN_NICKS=true

# Prosody REST (internal hostname; Portal uses when provisioning)
PROSODY_REST_URL=http://atl-xmpp-server:5280
PROSODY_REST_USERNAME=admin@xmpp.localhost
PROSODY_REST_PASSWORD=change_me_prosody_rest_password

# IRC Portal URLs (internal hostnames)
IRC_ATHEME_JSONRPC_URL=http://atl-irc-server:8081/jsonrpc
IRC_UNREAL_JSONRPC_URL=https://irc.localhost:8600/api
IRC_SERVER=irc.localhost
IRC_PORT=6697

# Web frontend (browser-accessible; localhost)
NEXT_PUBLIC_IRC_WS_URL=wss://irc.localhost/ws
NEXT_PUBLIC_XMPP_BOSH_URL=https://xmpp.localhost/http-bind

# The Lounge (dev: localhost:9000)
THELOUNGE_PORT=9000
