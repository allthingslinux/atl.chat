# =============================================================================
# ATL Chat - Root Docker Compose
# =============================================================================
# Orchestrates all services across the entire stack.
# All compose fragments live under infra/compose/
#
# Usage:
#   docker compose up -d              # Start all services
#   docker compose --profile dev up  # Start with dev services (Dozzle, etc.)
# =============================================================================

name: atl-chat

include:
  - infra/compose/networks.yaml
  - infra/compose/cert-manager.yaml
  - infra/compose/irc.yaml
  - infra/compose/xmpp.yaml
  - infra/compose/bridge.yaml

services:
  dozzle:
    image: amir20/dozzle:v8
    container_name: dozzle
    restart: unless-stopped
    profiles: [ "dev" ]
    ports:
      - "${DOZZLE_PORT:-8082}:8080"
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock:ro
    environment:
      - DOZZLE_FILTER=name=atl-*
    networks:
      - atl-chat
